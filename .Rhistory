integrate(f=fYL,lower=0,upper=Inf)
integrate(f=fYL,lower=0,upper=Inf)
?dbinom
fx <- function(t){
dnorm(x = t)
}
fy <- function(t){
dnorm(x = t,mean = 5)
}
fz <- function(t){
0.4*fx(t)+0.6*fy(t)
}
plot(fx,from = -5, to = 10,lwd=2,col="red")
plot(fy,from = -5, to = 10,lwd=2,col="blue",add=T)
plot(fz,from = -5, to = 10,lwd=2,col="purple",add=T)
?dnorm
plot(faln,from = -5, to = 10,lwd=2,col="purple",add=T)
plot(faln,from = 0, to = 10,lwd=2,col="purple",add=T)
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
fx <- function(t){
dnorm(x = t)
}
fy <- function(t){
dnorm(x = t,mean = 5)
}
fy <- function(t){
dnorm(x = t,mean = 5)
}
fz <- function(t){
0.4*fx(t)+0.6*fy(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
plot(fx,from = -5, to = 10,lwd=2,col="red")
plot(fan,from = -5, to = 10,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 10,lwd=2,col="purple",add=T)
pnorm(q=1.5,mean = 0.483,sd=0.478897)
dlnorm(q=1.5,meanlog = -1.285769168 ,sdlog = 1.116061085)
plnorm(q=1.5,meanlog = -1.285769168 ,sdlog = 1.116061085)
plnorm(q=2,meanlog = -1.285769168 ,sdlog = 1.116061085)
fn <- function(t){
dbinom(x = t,size=22,prob=0.005)
}
fm <- function(t){
dbinom(x = t,size=18,prob=0.006)
}
fx <- function(t){
dbinom(x = t,size=15,prob=0.009)
}
fy <- function(t){
dbinom(x = t,size=10,prob=0.013)
}
fsum <- function(t){
0.25*fx(t)+0.25*fy(t)+0.25*fn(t)+0.25*fm(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
plot(fsum,from = -5, to = 10,lwd=2,col="red")
plot(fan,from = -5, to = 10,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 10,lwd=2,col="purple",add=T)
fn <- function(t){
dbinom(x = t,size=22,prob=0.005)
}
fm <- function(t){
dbinom(x = t,size=18,prob=0.006)
}
fx <- function(t){
dbinom(x = t,size=15,prob=0.009)
}
fy <- function(t){
dbinom(x = t,size=10,prob=0.013)
}
fsum <- function(t){
0.25*fx(t)+0.25*fy(t)+0.25*fn(t)+0.25*fm(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
plot(fsum,from = -5, to = 10,lwd=2,col="red")
plot(fan,from = -5, to = 10,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 10,lwd=2,col="purple",add=T)
plot(fsum,from = -5, to = 10,lwd=2,col="red")
plot(fn,from = -5, to = 10,lwd=2,col="red")
plot(fan,from = -5, to = 10,lwd=2,col="blue",add=T)
plot(fn,from = -5, to = 10,lwd=2,col="red")
plot(fy,from = -5, to = 10,lwd=2,col="red")
plot(fy,from = 0, to = 5,lwd=2,col="red")
plot(fn,from = -5, to = 10,lwd=2,col="blue",add=T)
fn <- function(t){
dbinom(x = t,size=22,prob=0.005)
}
fm <- function(t){
dbinom(x = t,size=18,prob=0.006)
}
fx <- function(t){
dbinom(x = t,size=15,prob=0.009)
}
fy <- function(t){
dbinom(x = t,size=10,prob=0.013)
}
fsum <- function(t){
0.25*fx(t)+0.25*fy(t)+0.25*fn(t)+0.25*fm(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
plot(fan,from = 0, to = 3,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 3,lwd=2,col="purple",add=T)
fn <- function(t){
dbinom(x = t,size=22,prob=0.005)
}
fm <- function(t){
dbinom(x = t,size=18,prob=0.006)
}
fx <- function(t){
dbinom(x = t,size=15,prob=0.009)
}
fy <- function(t){
dbinom(x = t,size=10,prob=0.013)
}
fsum <- function(t){
0.25*fx(t)+0.25*fy(t)+0.25*fn(t)+0.25*fm(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085)
}
plot(fan,from = 0, to = 3,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 3,lwd=2,col="purple",add=T)
pnorm(q=2,mean = 0.483,sd=0.478897)
1-pnorm(q=2,mean = 0.483,sd=0.478897)
1-pnorm(q=2,mean = 0.483,sd=0.478897^0.5)
0.478897^0.5
1-pnorm(q=1.5,mean = 0.483,sd=0.6920238)
1-plnorm(q=2,meanlog = -1.285769168 ,sdlog = 1.116061085^0.5)
1-plnorm(q=2,meanlog = -1.285769168 ,sdlog = 1.116061085^0.5)
1-plnorm(q=1.5,meanlog = -1.285769168 ,sdlog = 1.116061085^0.5)
fn <- function(t){
dbinom(x = t,size=22,prob=0.005)
}
fm <- function(t){
dbinom(x = t,size=18,prob=0.006)
}
fx <- function(t){
dbinom(x = t,size=15,prob=0.009)
}
fy <- function(t){
dbinom(x = t,size=10,prob=0.013)
}
fsum <- function(t){
0.25*fx(t)+0.25*fy(t)+0.25*fn(t)+0.25*fm(t)
}
fan <- function(t){
dnorm(x = t,mean = 0.483,sd=0.478897^0.5)
}
faln <- function(t){
dlnorm(x = t,meanlog = -1.285769168 ,sdlog = 1.116061085^0.5)
}
plot(fan,from = 0, to = 3,lwd=2,col="blue",add=T)
plot(faln,from = 0, to = 3,lwd=2,col="purple",add=T)
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
glimpse(Data_raw_Sec67)
Data <- inner_join(Data_raw_Sec3, Data_raw_Sec45) %>%
inner_join(Data_raw_Sec67) %>%
select(-ID_PER, -CVE_ENT, -CVE_MUN, -AP6_1_2) %>%
filter(AP7_3_05 != 9,AP7_3_06 != 9,AP7_3_07 != 9,AP7_3_08 != 9,AP7_3_09 != 9,
AP7_3_10 != 9,AP7_3_11 != 9,AP7_3_12 != 9,AP7_3_13 != 9,AP7_3_14 != 9,AP7_3_15 != 9) %>%
mutate(AP7_4_05 = replace_na( AP7_4_05, 0), AP7_4_06 = replace_na(AP7_4_06, 0),AP7_4_07 = replace_na( AP7_4_07, 0),
AP7_4_08 = replace_na( AP7_4_08, 0),AP7_4_09 = replace_na( AP7_4_09, 0),AP7_4_10 = replace_na( AP7_4_10, 0),
AP7_4_11 = replace_na( AP7_4_11, 0),AP7_4_12 = replace_na( AP7_4_12, 0),AP7_4_13 = replace_na( AP7_4_13, 0),
AP7_4_14 = replace_na( AP7_4_14, 0),AP7_4_15 = replace_na( AP7_4_15, 0)) %>%
select(-AP7_3_05,-AP7_3_06,-AP7_3_07,-AP7_3_08,-AP7_3_09,-AP7_3_10,-AP7_3_11,-AP7_3_12,-AP7_3_13,-AP7_3_14,-AP7_3_15)
#mutate(Num_Inc = AP7_4_13 + AP7_4_14) %>%
#select(-AP7_4_13, -AP7_4_14)
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
glimpse(Data_raw_Sec67)
Data <- inner_join(Data_raw_Sec3, Data_raw_Sec45) %>%
inner_join(Data_raw_Sec67) %>%
select(-ID_PER, -CVE_ENT, -CVE_MUN, -AP6_1_2) %>%
filter(AP7_3_05 != 9,AP7_3_06 != 9,AP7_3_07 != 9,AP7_3_08 != 9,AP7_3_09 != 9,
AP7_3_10 != 9,AP7_3_11 != 9,AP7_3_12 != 9,AP7_3_13 != 9,AP7_3_14 != 9,AP7_3_15 != 9) %>%
mutate(AP7_4_05 = replace_na( AP7_4_05, 0), AP7_4_06 = replace_na(AP7_4_06, 0),AP7_4_07 = replace_na( AP7_4_07, 0),
AP7_4_08 = replace_na( AP7_4_08, 0),AP7_4_09 = replace_na( AP7_4_09, 0),AP7_4_10 = replace_na( AP7_4_10, 0),
AP7_4_11 = replace_na( AP7_4_11, 0),AP7_4_12 = replace_na( AP7_4_12, 0),AP7_4_13 = replace_na( AP7_4_13, 0),
AP7_4_14 = replace_na( AP7_4_14, 0),AP7_4_15 = replace_na( AP7_4_15, 0)) %>%
select(-AP7_3_05,-AP7_3_06,-AP7_3_07,-AP7_3_08,-AP7_3_09,-AP7_3_10,-AP7_3_11,-AP7_3_12,-AP7_3_13,-AP7_3_14,-AP7_3_15)
#mutate(Num_Inc = AP7_4_13 + AP7_4_14) %>%
#select(-AP7_4_13, -AP7_4_14)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
setwd("C:/Users/edson/Documents/BayesProject")
load("C:/Users/edson/Documents/BayesProject/BD_CDMX2.Rda")
library(rjags)
library(tidyverse)
library(ROCR)
library(pROC)
library(car)
##Creamos base con respuesta 1 y 0
CData_CDMX3 <- CData_CDMX2 %>%
mutate(Vic_Rob_As = ifelse(Vic_Rob_As>0,1,0))
CData_CDMX3$Vic_Rob_As <- as_factor(CData_CDMX3$Vic_Rob_As)
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = Sit_Lab == "Empleado")
View(CData_CDMX4)
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0))
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0), SinOcup = ifelse(Sit_Lab == "Sin Ocupación",1,0),
EstDom = ifelse(Sit_Lab == "Estudiantes y Domésticos",1,0))
levels(CData_CDMX3$Nivel_Edu)
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0), SinOcup = ifelse(Sit_Lab == "Sin Ocupación",1,0),
EstDom = ifelse(Sit_Lab == "Estudiantes y Domésticos",1,0), CP = ifelse(Region == "Centro Poniente",1,0),
S = ifelse(Region == "Sur",1,0), N = ifelse(Region == "Norte",1,0), O = ifelse(Region == "Oriente",1,0),
NB = ifelse(Nivel_Edu == "No Básica",1,0), Sec =ifelse(Nivel_Edu == "Secundaria",1,0),
MS = ifelse(Nivel_Edu == "Medio Superior",1,0), Sup = ifelse(Nivel_Edu == "Superior"),
Pos = ifelse(Nivel_Edu == "Posgrado"))
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0), SinOcup = ifelse(Sit_Lab == "Sin Ocupación",1,0),
EstDom = ifelse(Sit_Lab == "Estudiantes y Domésticos",1,0), CP = ifelse(Region == "Centro Poniente",1,0),
S = ifelse(Region == "Sur",1,0), N = ifelse(Region == "Norte",1,0), O = ifelse(Region == "Oriente",1,0),
NB = ifelse(Nivel_Edu == "No Básica",1,0), Sec =ifelse(Nivel_Edu == "Secundaria",1,0),
MS = ifelse(Nivel_Edu == "Medio Superior",1,0), Sup = ifelse(Nivel_Edu == "Superior",1,0),
Pos = ifelse(Nivel_Edu == "Posgrado",1,0))
View(CData_CDMX4)
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0), SinOcup = ifelse(Sit_Lab == "Sin Ocupación",1,0),
EstDom = ifelse(Sit_Lab == "Estudiantes y Domésticos",1,0), CP = ifelse(Region == "Centro Poniente",1,0),
S = ifelse(Region == "Sur",1,0), N = ifelse(Region == "Norte",1,0), O = ifelse(Region == "Oriente",1,0),
NB = ifelse(Nivel_Edu == "No Básica",1,0), Sec =ifelse(Nivel_Edu == "Secundaria",1,0),
MS = ifelse(Nivel_Edu == "Medio Superior",1,0), Sup = ifelse(Nivel_Edu == "Superior",1,0),
Pos = ifelse(Nivel_Edu == "Posgrado",1,0)) %>%
select(-Vic_Rob_As,-Region,-Nivel_Edu,-Sit_Lab)
CData_CDMX4 <- CData_CDMX3 %>%
mutate(Empleado = ifelse(Sit_Lab == "Empleado",1,0), SinOcup = ifelse(Sit_Lab == "Sin Ocupación",1,0),
EstDom = ifelse(Sit_Lab == "Estudiantes y Domésticos",1,0), CP = ifelse(Region == "Centro Poniente",1,0),
S = ifelse(Region == "Sur",1,0), N = ifelse(Region == "Norte",1,0), O = ifelse(Region == "Oriente",1,0),
NB = ifelse(Nivel_Edu == "No Básica",1,0), Sec =ifelse(Nivel_Edu == "Secundaria",1,0),
MS = ifelse(Nivel_Edu == "Medio Superior",1,0), Sup = ifelse(Nivel_Edu == "Superior",1,0),
Pos = ifelse(Nivel_Edu == "Posgrado",1,0)) %>%
select(-Vic_Rob_As,-Region,-Nivel_Edu,-Sit_Lab, -Imp_Seg)
library(rjags)
library(tidyverse)
library(ROCR)
library(pROC)
library(car)
##Creamos base con respuesta 1 y 0
CData_CDMX3 <- CData_CDMX2 %>%
mutate(Vic_Rob_As = ifelse(Vic_Rob_As>0,1,0))
CData_CDMX3$Vic_Rob_As <- as_factor(CData_CDMX3$Vic_Rob_As)
## Primer modelo con todas las covariables
modlog1 <- glm(Vic_Rob_As ~ .,family = "binomial", data=CData_CDMX3)
summary(modlog1)
## Hallamos punto de corte gráfica y teóricamente
predictions1 <- prediction(modlog1$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions1, "sens")@x.values), unlist(performance(predictions1, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions1, "spec")@x.values), unlist(performance(predictions1, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest1 <- abs(unlist(performance(predictions1, "sens")@y.values)-unlist(performance(predictions1, "spec")@y.values))
opt1 <- unlist(performance(predictions1, "sens")@x.values)[which(rest1==min(rest1))]
vif(modlog1)
#Matriz de Confusión
r <- ifelse(modlog1$fitted.values>=opt1,1,0)
table(r,CData_CDMX3$Vic_Rob_As)  ###62.32%
## Segundo modelo sin Importancia de la Seguridad
modlog2 <- glm(Vic_Rob_As ~ Edad + Seg_Mun + Mas_Pat_Vil, family = "binomial",data=CData_CDMX3)
summary(modlog2)
#Punto de Corte
predictions2 <- prediction(modlog2$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions2, "sens")@x.values), unlist(performance(predictions2, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions2, "spec")@x.values), unlist(performance(predictions2, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest2 <- abs(unlist(performance(predictions2, "sens")@y.values)-unlist(performance(predictions2, "spec")@y.values))
opt2 <- unlist(performance(predictions2, "sens")@x.values)[which(rest2==min(rest2))]
vif(modlog2)
r <- ifelse(modlog2$fitted.values>=opt2,1,0)
table(r,CData_CDMX3$Vic_Rob_As)  ###62.02%
## Nivel Educativo
modlog3 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Region, family = "binomial",data=CData_CDMX3)
summary(modlog3)
predictions3 <- prediction(modlog3$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions3, "sens")@x.values), unlist(performance(predictions3, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions3, "spec")@x.values), unlist(performance(predictions3, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest3 <- abs(unlist(performance(predictions3, "sens")@y.values)-unlist(performance(predictions3, "spec")@y.values))
opt3 <- unlist(performance(predictions3, "sens")@x.values)[which(rest3==min(rest3))]
vif(modlog3)
r3 <- ifelse(modlog2$fitted.values>=opt3,1,0)
table(r3,CData_CDMX3$Vic_Rob_As)  ##62.26%
y<-exp(-.297618+-0.023261*36+0.522345+0.147011)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
y/(1+y)
0.38564676
## log log  clog log
modlog3 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Region + Nivel_Edu, family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
outlierTest(modlog2)
CData_CDMX4 <- CData_CDMX3[c(-824,-755),]
modlog4 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Nivel_Edu + Region, family = "binomial",data=CData_CDMX4)
summary(modlog4)
#Punto de Corte
predictions4 <- prediction(modlog4$fitted.values,CData_CDMX4$Vic_Rob_As)
plot(unlist(performance(predictions4, "sens")@x.values), unlist(performance(predictions4, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions4, "spec")@x.values), unlist(performance(predictions4, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest4 <- abs(unlist(performance(predictions4, "sens")@y.values)-unlist(performance(predictions4, "spec")@y.values))
opt4 <- unlist(performance(predictions4, "sens")@x.values)[which(rest4==min(rest4))]
vif(modlog4)
r <- ifelse(modlog2$fitted.values>=opt2,1,0)
table(r,CData_CDMX3$Vic_Rob_As)  ###62.02%
outlierTest(modlog4)
## Jags
attach(CData_CDMX3)
# data <- list(
#   y = as.numeric(Vic_Rob_As)-1,
#   x1 = Edad,
#   x3 = as.numeric(Seg_Mun)-1,
#   x4 = as.numeric(Mas_Pat_Vil)-1,
#   n = nrow(CData_CDMX3)
# )
# data <- list(
#   y = as.numeric(Vic_Rob_As)-1,
#   x1 = as.numeric(Region == "Centro Poniente"),
#   x2 = as.numeric(Region == "Sur"),
#   x3 = as.numeric(Region == "Norte"),
#   x4 = as.numeric(Region == "Oriente"),
#   n = nrow(CData_CDMX3)
# )
# param <- c("alpha","beta11","beta13","beta14")
#
# inits<-function(){list(
#   "alpha" = rnorm(1),
#   "beta11" = rnorm(1),
#   "beta12" = rnorm(1),
#   "beta14" = rnorm(1)
# )
# }
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = Edad,
x2 = as.numeric(Seg_Mun)-1,
x3 = as.numeric(Mas_Pat_Vil)-1,
x41 = as.numeric(Sit_Lab == "Empleado"),
x42 = as.numeric(Sit_Lab == "Sin Ocupación"),
x43 = as.numeric(Sit_Lab == "Estudiantes y Domésticos"),
x51 = as.numeric(Region == "Centro Poniente"),
x52 = as.numeric(Region == "Sur"),
x53 = as.numeric(Region == "Norte"),
x54 = as.numeric(Region == "Oriente"),
x61 = as.numeric(Nivel_Edu == "No Básica"),
x62 = as.numeric(Nivel_Edu == "Secundaria"),
x63 = as.numeric(Nivel_Edu == "Medio Superior"),
x64 = as.numeric(Nivel_Edu == "Superior"),
x65 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3", "beta41",
"beta42", "beta43", "beta51", "beta52",
"beta53", "beta54", "beta61", "beta62",
"beta63", "beta64", "beta65")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta41" = rnorm(1),
"beta42" = rnorm(1),
"beta43" = rnorm(1),
"beta51" = rnorm(1),
"beta52" = rnorm(1),
"beta53" = rnorm(1),
"beta54" = rnorm(1),
"beta61" = rnorm(1),
"beta62" = rnorm(1),
"beta63" = rnorm(1),
"beta64" = rnorm(1),
"beta65"= rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
dev.off()
summary(sample)
#Comparar
modlog4 <- glm(Vic_Rob_As ~ Region, family = "binomial",data=CData_CDMX3)
summary(modlog4)
plot(sample)
plot(sample)
library(tidyverse)
library(corrplot)
library(polycor)
library(glm2)
library(pscl)
library(boot)
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm<-summary(mod)
sglm
mod1 <- glm(Vic_Rob_As ~ Edad, family = "poisson",data = CData_CDMX2)
sglm1 <- summary(mod1)
#Ejemplo
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*42)/(1+exp(b0_2+b1_2*42))
lam<-exp(b0_1+b1_1*42)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
b0 <- sglm1$coefficients[1,1]
b1 <- sglm1$coefficients[1,1]
lam1 <- exp(b0 + b1*42)
vec1 <- rep(0,10)
for(t in 0:9){
vec1[t+1] <- dpois(t,lam1)
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 42)
vec_base <- rep(vec[1:8],775)[1:5419]
vec_base1 <- rep(vec1[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec_base))
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec_base1))
sglm1
b1 <- sglm1$coefficients[1,2]
b1 <- sglm1$coefficients[2,1]
lam1 <- exp(b0 + b1*42)
vec1 <- rep(0,10)
for(t in 0:9){
vec1[t+1] <- dpois(t,lam1)
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 42)
vec_base <- rep(vec[1:8],775)[1:5419]
vec_base1 <- rep(vec1[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec_base))
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec_base1))
