## Eliminamos sexo
Region <- rep(0,length(CData_CDMX1$Nom_Mun))
for(i in 1:length(CData_CDMX1$Nom_Mun)){
if(CData_CDMX1$Nom_Mun[i] %in% c("Gustavo A. Madero","Venustiano Carranza","Iztacalco")){
Region[i] <- "Norte"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Cuauhtemoc","Miguel Hidalgo","Azcapotzalco","Alvaro Obregon","Cuajimalpa de Morelos")){
Region[i] <- "Centro Poniente"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Benito Juarez","Coyoacan","Tlalpan","La Magdalena Contreras")){
Region[i] <- "Sur"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Iztapalapa","Tlahuac","Xochimilco","Milpa Alta")){
Region[i] <- "Oriente"
}
}
Nivel_Edu <- rep("",length(CData_CDMX1$Niv_Edu))
for(i in 1:length(CData_CDMX1$Niv_Edu)){
if(CData_CDMX1$Niv_Edu[i] %in% c(1,2)){
Nivel_Edu[i]<-"Prepri/Prim"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(3,4,5)){
Nivel_Edu[i]<-"Secundaria"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(6,7)){
Nivel_Edu[i]<-"Medio Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 8){
Nivel_Edu[i]<-"Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 9){
Nivel_Edu[i]<-"Posgrado"
}else if(CData_CDMX1$Niv_Edu[i] == 0){
Nivel_Edu[i]<-"Ninguno"
}
}
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
View(CData_CDMX2)
library(ggplot2)
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
summary(CData_CDMX2)
table(CData_CDMX2$Sit_Lab_Act ,CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As)))
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As
)
)
C <- CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))
table(CData_CDMX2, C$TotalDelitos)
table(CData_CDMX2$Sit_Lab_Act, C$TotalDelitos)
c
C$TotalDelitos
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White")
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White")
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX3$Region <- as_factor(CData_CDMX3$Region)
CData_CDMX3$Nivel_Edu <- factor(CData_CDMX3$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX3$Sit_Lab <- as_factor(CData_CDMX3$Sit_Lab)
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX3$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX3$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX3$Sit_Lab)
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX2$Sit_Lab)
View(CData_CDMX2)
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
View(CData_CDMX2)
CData_CDMX3 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
Sit_Lab <- rep("",length(CData_CDMX1$Sit_Lab_Act))
for(i in 1:length(CData_CDMX1$Sit_Lab_Act)){
if(CData_CDMX1$Sit_Lab_Act[i] %in% c(1,2,3)){
Sit_Lab[i] <- "Empleado"
}else if(CData_CDMX1$Sit_Lab_Act[i] %in% c(4,5)){
Sit_Lab[i] <- "Estudiantes y Domésticos"
}else if(CData_CDMX1$Sit_Lab_Act[i] %in% c(6,7,8)){
Sit_Lab[i] <- "Sin Ocupación"
}
}
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX2$Sit_Lab)
View(CData_CDMX2)
# GrÃ¡fica por SituaciÃ³n Laboral
CData_CDMX2 %>% #group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(y = Sit_Lab, color = Sit_Lab, fill = Sit_Lab)) +
geom_bar(color = "White") +
coord_polar(theta = "y")
summary(CData_CDMX2)
CData_CDMX2 %>% group_by(Sit_Lab) %>% summarise(TotalDelitos = sum(Vic_Rob_As))
CData_CDMX2 %>% group_by(Sit_Lab) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = Sit_Lab, color = Sit_Lab, fill = Sit_Lab)) +
geom_bar(color = "White", stat = "identity") +
coord_polar(theta = "y")
# GrÃ¡fica por SituaciÃ³n Laboral
CData_CDMX2 %>% group_by(Sit_Lab) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab, fill = Sit_Lab)) +
geom_bar(color = "White", stat = "identity") +
coord_polar(theta = "y")
au <- hetcor(CData_CDMX2)
au2 <- au$correlations
corrplot(au2)
au <- hetcor(CData_CDMX1)
au2 <- au$correlations
corrplot(au2)
r <- xtabs(~Vic_Rob_As + Vehic, data=CData_CDMX2)
r
chisq.test(r)
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act, -Vehic) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX2$Sit_Lab)
au <- hetcor(CData_CDMX2)
au2 <- au$correlations
corrplot(au2)
View(CData_CDMX2)
au <- hetcor(CData_CDMX2)
View(CData_CDMX2)
au <- hetcor(CData_CDMX2)
warnings()
View(au)
au2 <- au$correlations
corrplot(au2)
r <- xtabs(~Vic_Rob_As + Region, data=CData_CDMX2)
chisq.test(r)
r
View(au2)
Nivel_Edu <- rep("",length(CData_CDMX1$Niv_Edu))
for(i in 1:length(CData_CDMX1$Niv_Edu)){
if(CData_CDMX1$Niv_Edu[i] %in% c(0,1,2)){
Nivel_Edu[i]<-"No Básica"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(3,4,5)){
Nivel_Edu[i]<-"Secundaria"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(6,7)){
Nivel_Edu[i]<-"Medio Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 8){
Nivel_Edu[i]<-"Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 9){
Nivel_Edu[i]<-"Posgrado"
}
}
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act, -Vehic) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX2$Sit_Lab)
au <- hetcor(CData_CDMX2)
au2 <- au$correlations
corrplot(au2)
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act, -Vehic) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("No Básica","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX2$Sit_Lab <- as_factor(CData_CDMX2$Sit_Lab)
au <- hetcor(CData_CDMX2)
au2 <- au$correlations
corrplot(au2)
View(au)
View(au2)
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm2<-summary(mod)
sglm2
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm<-summary(mod)
sglm
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*42)/(1+exp(b0_2+b1_2*42))
lam<-exp(b0_1+b1_1*42)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX %>%
filter(Edad == 42)
Edad42<-CData_CDMX %>%
filter(Edad == 42)
ggplot(data=Edad42,aes(x=Vic_Rob_As)) + geom_histogram()
ggplot(data=Edad42,aes(x=Vic_Rob_As)) + geom_histogram(aes(y=..density..))
ggplot(data=Edad42,aes(x=Vic_Rob_As, y = ..density..)) + geom_histogram()
Edad42<-CData_CDMX2 %>%
filter(Edad == 42) %>%
mutate(Densidad = Vic_Rob_As/sum(Vic_Rob_As>0))
ggplot(data=Edad42,aes(x=Densidad)) + geom_histogram()
vec1 <- vec*length(Edad42$Vic_Rob_As)
ggplot(CData_CDMX2, aes(x=Vic_Rob_As)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent)
vec
ggplot() + geom_point(aes(x=0:6 , y[1:7]))
ggplot() + geom_point(aes(x=0:6 , y=vec[1:7]))
ggplot(CData_CDMX2, aes(x=Vic_Rob_As)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=0:6 , y=vec[1:7]))
ggplot(CData_CDMX2, aes(x=Vic_Rob_As)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + ggplot() + geom_point(aes(x=0:6 , y=vec[1:7]))
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=0:6 , y=vec[1:7]))
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent)
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=0:6 , y=vec[1:7]))
rep(1:6,40)
v<-rep(0:6,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec[1:7]))
vec1 <- rep(vec[1:7],775)[1:5419]
v<-rep(0:6,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec[1:7]))
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm<-summary(mod)
sglm
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*40)/(1+exp(b0_2+b1_2*40))
lam<-exp(b0_1+b1_1*40)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 40)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
CData_CDMX2_1 <-CData_CDMX2 %>%
select(-Vic_Rob_As)
summary(predict(m2,newdata = CData_CDMX2_1))
logit<-exp(b0_2+b1_2*60)/(1+exp(b0_2+b1_2*60))
lam<-exp(b0_1+b1_1*60)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 60)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*25)/(1+exp(b0_2+b1_2*25))
lam<-exp(b0_1+b1_1*25)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 25)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
CData_CDMX2_1 <-CData_CDMX2 %>%
select(-Vic_Rob_As)
library(broom)
tidy(mod)
mod<-glm(Vic_Rob_As ~ Nivel_Edu + Sit_Lab_Act, family = "poisson",data = CData_CDMX2)
mod<-glm(Vic_Rob_As ~ Nivel_Edu + Sit_Lab, family = "poisson",data = CData_CDMX2)
tidy(mod)
####Guardamos bases de datos
save(CData_CDMX2,file="BD_CDMX2")
####Guardamos bases de datos
save(CData_CDMX2,file="BD_CDMX2.Rda")
CData_CDMX3 <- CData_CDMX2 %>%
mutate(Vic_Rob_As = ifelse(Vic_Rob_As>0,1,0))
View(Data_CDMX.9)
View(CData_CDMX3)
summary(CData_CDMX2)
summary(CData_CDMX3)
sum(CData_CDMX2$Vic_Rob_As>0)
sum(CData_CDMX3)
sum(CData_CDMX3$Vic_Rob_As)
modlog <- glm(Vic_Rob_As ~ .,family = "Binomial", data=CData_CDMX3)
modlog <- glm(Vic_Rob_As ~ .,family = "binomial", data=CData_CDMX3)
summary(modlog)
modlog$fitted.values
r <- ifelse(modlog$fitted.values>0.5,1,0)
r <- ifelse(modlog$fitted.values>0.5,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
library(car)
vif(modlog)
r <- ifelse(modlog$fitted.values>=0.5,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
?table
?table()
is.factor(CData_CDMX3$Vic_Rob_As)
CData_CDMX3$Vic_Rob_As <- as_factor(CData_CDMX3$Vic_Rob_As)
sum(CData_CDMX2$Vic_Rob_As>0)
sum(CData_CDMX3$Vic_Rob_As)
modlog <- glm(Vic_Rob_As ~ .,family = "binomial", data=CData_CDMX3)
summary(modlog)
r <- ifelse(modlog$fitted.values>=0.5,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
library(car)
vif(modlog)
(4330+1)/5419
modlog1 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Nivel_Edu + Region, family = "binomial",data=CData_CDMX3)
summary(modlog1)
modlog <- glm(Vic_Rob_As ~ .,family = binomial(link = "logit"), data=CData_CDMX3)
summary(modlog)
summary(modlog1)
vif(modlog1)
r1 <- ifelse(modlog1$fitted.values>=0.5,1,0)
table(r1,CData_CDMX3$Vic_Rob_As)
(4332)/5419
modlog2 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Region, family = "binomial",data=CData_CDMX3)
summary(modlog2)
vif(modlog2)
r2 <- ifelse(modlog2$fitted.values>=0.5,1,0)
table(r2,CData_CDMX3$Vic_Rob_As)
y<-exp(-.297618+-0.023261*36+0.522345+0.147011)
modlog2$fitted.values
y/(1+y)
vec <- rbern(1,modlog2$fitted.values)
vec <- rbinom(1,1,modlog2$fitted.values)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
vec
table(vec,CData_CDMX3$Vic_Rob_As)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
vec <- rbinom(length(modlog2$fitted.values),1,modlog2$fitted.values)
table(vec,CData_CDMX3$Vic_Rob_As)
rbinom(2,1, c(0,1))
rbinom(2,1, c(1,0))
rbinom(2,1, c(0.5,0.5))
rbinom(2,1, c(0.5,0.5))
rbinom(2,1, c(0.5,0.5))
rbinom(2,1, c(0.5,0.5))
table(vec,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ Edad, family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ Edad + Sit_Lab, family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
summary(modlog1)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ ., family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
modlog3 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Region + Nivel_Edu, family = "binomial",data=CData_CDMX3)
summary(modlog3)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
table(vec1,CData_CDMX3$Vic_Rob_As)
inits<-function(){list(
"alpha" = rnorm(1),
"beta" = rnorm(1),
"beta" = rnorm(1),
"beta" = rnorm(1),
)}
"beta" = rnorm(1),
library(rjags)
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3","beta4","beta5","beta6")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1),
"beta5" = rnorm(1),
"beta6" = rnorm(1),
)
}
fit <- jags.model("Modelo.bug", data, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
vec1 <- rbinom(length(modlog3$fitted.values),1,modlog3$fitted.values)
