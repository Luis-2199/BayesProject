CData_CDMX3 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX3$Region <- as_factor(CData_CDMX3$Region)
CData_CDMX3$Nivel_Edu <- factor(CData_CDMX3$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX3$Sit_Lab <- as_factor(CData_CDMX3$Sit_Lab)
save(CData_CDMX3,file="BD_CDMX3.Rda")
View(CData_CDMX3)
View(CData_CDMX2)
unique(CData_CDMX2$Sit_Lab_Act)
Sit_Lab <- rep("",length(CData_CDMX1$Sit_Lab_Act))
for(i in 1:length(CData_CDMX1$Sit_Lab_Act)){
if(CData_CDMX1$Sit_Lab_Act[i] %in% c(1,2,3)){
Sit_Lab[i] <- "Empleado"
}else if(CData_CDMX1$Sit_Lab_Act[i] == 4){
Sit_Lab[i] <- "Estudiante"
}else if(CData_CDMX1$Sit_Lab_Act[i] == 5){
Sit_Lab[i] <- "DomÃ©stico"
}else if(CData_CDMX1$Sit_Lab_Act[i] %in% c(6,7)){
Sit_Lab[i] <- "Jub/Pens/Inc"
}else if(CData_CDMX1$Sit_Lab_Act[i] == 8){
Sit_Lab[i] <- "Desempleado"
}
}
CData_CDMX3 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu, -Sit_Lab_Act) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu, Sit_Lab = Sit_Lab)
CData_CDMX3$Region <- as_factor(CData_CDMX3$Region)
CData_CDMX3$Nivel_Edu <- factor(CData_CDMX3$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
CData_CDMX3$Sit_Lab <- as_factor(CData_CDMX3$Sit_Lab)
View(CData_CDMX3)
mod3 <- zeroinfl(Vic_Rob_As ~ Region + Edad + Sit_Lab +
Imp_Seg + Seg_Mun + Mas_Pat_Vil + Vehic,
data=training,dist="poisson",link="logit")
mod3 <- zeroinfl(Vic_Rob_As ~ Region + Edad + Sit_Lab +
Imp_Seg + Seg_Mun + Mas_Pat_Vil + Vehic,
data=CData_CDMX3,dist="poisson",link="logit")
summary(mod3)
# setwd("C:/Users/edson/Documents/BayesProject")
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
library(tidyverse)
# setwd("C:/Users/edson/Documents/BayesProject")
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
glimpse(Data_raw_Sec67)
Data <- inner_join(Data_raw_Sec3, Data_raw_Sec45) %>%
inner_join(Data_raw_Sec67) %>%
select(-ID_PER, -CVE_ENT, -CVE_MUN, -AP6_1_2,-AP7_3_07,-AP7_3_08,-AP7_3_09,-AP7_3_10,-AP7_3_11,-AP7_3_12,-AP7_3_15,
-AP7_4_07,-AP7_4_08,-AP7_4_09,-AP7_4_10,-AP7_4_11,-AP7_4_12,-AP7_4_15) %>%
filter(AP7_3_05 != 9,AP7_3_06 != 9,AP7_3_13 != 9,AP7_3_14 != 9) %>%
mutate(AP7_4_05 = replace_na( AP7_4_05, 0), AP7_4_06 = replace_na(AP7_4_06, 0),AP7_4_13 = replace_na( AP7_4_13, 0),
AP7_4_14 = replace_na( AP7_4_14, 0)) %>%
select(-AP7_3_05,-AP7_3_06,-AP7_3_13,-AP7_3_14) %>%
mutate(Vic_Rob_As = AP7_4_06 + AP7_4_05,Vic_Sex = AP7_4_13 + AP7_4_14) %>%
select(-AP7_4_13, -AP7_4_14,-AP7_4_05,-AP7_4_06)
Data_CDMX <- Data %>%
filter(Nom_Ent == "Ciudad de Mexico") %>%
mutate(Sit_Lab_Act =AP3_8, Pos_OCup =replace_na( AP3_10, 0), Imp_Seg = AP4_2_05, Seg_Loc=AP4_3_1, Seg_Mun =AP4_3_2, Alum =AP4_8_1,
Agua=AP4_8_2,Pandill=AP4_8_4,Robos=AP4_8_5,Del_Esc=AP4_8_6,Mas_Op_Del=AP5_1_08,Mas_Pat_Vil=AP5_1_10, Vehic=AP6_1_1) %>%
select(-AP3_8,-AP3_10,-AP4_2_05,-AP4_3_1,-AP4_3_2,-AP4_8_1,-AP4_8_2,-AP4_8_4,-AP4_8_5,-AP4_8_6,-AP5_1_08,-AP5_1_10,-AP6_1_1)
save(Data_CDMX,file="BD_CDMX_Vic.Rda")
# setwd("C:/Users/edson/Documents/BayesProject")
load(file="BD_CDMX_Vic.Rda")
for(i in 1:nrow(Data_CDMX)){
if(Data_CDMX$Pandill[i]==3){
Data_CDMX$Pandill[i]=2
}
if(Data_CDMX$Robos[i]==3){
Data_CDMX$Robos[i]=2
}
if(Data_CDMX$Del_Esc[i]==3){
Data_CDMX$Del_Esc[i]=2
}
if(Data_CDMX$Mas_Op_Del[i]==2){
Data_CDMX$Mas_Op_Del[i]=9
}
if(Data_CDMX$Mas_Op_Del[i]==3){
Data_CDMX$Mas_Op_Del[i]=2
}
if(Data_CDMX$Mas_Pat_Vil[i]==2){
Data_CDMX$Mas_Pat_Vil[i]=9
}
if(Data_CDMX$Mas_Pat_Vil[i]==3){
Data_CDMX$Mas_Pat_Vil[i]=2
}
}
Data_CDMX <- Data_CDMX %>%
filter(Edad!=98) %>%
select(-Nom_Ent,-Vic_Sex)
Data_CDMX2 <- Data_CDMX
Data_CDMX2$Nom_Mun <- as_factor(Data_CDMX2$Nom_Mun)
Data_CDMX2$Sexo <- as_factor(Data_CDMX2$Sexo)
Data_CDMX2$Niv_Edu <- as_factor(Data_CDMX2$Niv_Edu)
Data_CDMX2$Sit_Lab_Act <- as_factor(Data_CDMX2$Sit_Lab_Act)
Data_CDMX2$Pos_OCup <- as_factor(Data_CDMX2$Pos_OCup)
Data_CDMX2$Imp_Seg <- as_factor(Data_CDMX2$Imp_Seg)
Data_CDMX2$Seg_Loc <- as_factor(Data_CDMX2$Seg_Loc)
Data_CDMX2$Seg_Mun <- as_factor(Data_CDMX2$Seg_Mun)
Data_CDMX2$Alum <- as_factor(Data_CDMX2$Alum)
Data_CDMX2$Agua <- as_factor(Data_CDMX2$Agua)
Data_CDMX2$Pandill <- as_factor(Data_CDMX2$Pandill)
Data_CDMX2$Robos <- as_factor(Data_CDMX2$Robos)
Data_CDMX2$Del_Esc <- as_factor(Data_CDMX2$Del_Esc)
Data_CDMX2$Mas_Op_Del <- as_factor(Data_CDMX2$Mas_Op_Del)
Data_CDMX2$Mas_Pat_Vil <- as_factor(Data_CDMX2$Mas_Pat_Vil)
Data_CDMX2$Vehic <- as_factor(Data_CDMX2$Vehic)
sum_ini <- summary(Data_CDMX2)
colnames(Data_CDMX)
levels(Data_CDMX$Imp_Seg) #"0" "1"
levels(Data_CDMX$Seg_Loc) #"1" "2" "9"
levels(Data_CDMX$Seg_Mun) #"1" "2" "9"
levels(Data_CDMX$Alum) #"1" "2" "9"
levels(Data_CDMX$Agua) #"1" "2" "9"
levels(Data_CDMX$Pandill) #"1" "2" "9"
levels(Data_CDMX$Robos) #"1" "2" "9"
levels(Data_CDMX$Del_Esc) #"1" "2" "9"
levels(Data_CDMX$Mas_Op_Del) #"1" "2" "9"
levels(Data_CDMX$Mas_Pat_Vil) #"1" "2" "9"
levels(Data_CDMX$Vehic) #"1" "2" "9"
d1 <- Data_CDMX %>% filter(Vic_Rob_As != 0)
d2 <- Data_CDMX %>% filter(Vic_Rob_As == 0)
#d1
{
sum(d1$Seg_Loc==1) #262
sum(d1$Seg_Loc==2) #815/1077
sum(d1$Seg_Mun==1) #142
sum(d1$Seg_Mun==2) #937/1079
sum(d1$Alum==1) #635
sum(d1$Alum==2) #447/1082
sum(d1$Agua==1) #576
sum(d1$Agua==2) #506/1082
sum(d1$Pandill==1) #468
sum(d1$Pandill==2) #595/1063
sum(d1$Robos==1) #937
sum(d1$Robos==2) #142/1079
sum(d1$Del_Esc==1) #537
sum(d1$Del_Esc==2) #351/888
sum(d1$Mas_Op_Del==1) #301
sum(d1$Mas_Op_Del==2) #504/805
sum(d1$Mas_Pat_Vil==1) #365
sum(d1$Mas_Pat_Vil==2) #518/883
sum(d1$Vehic==1) #425
sum(d1$Vehic==2) #656/1081
}
#d2
{
sum(d2$Seg_Loc==1) #1517
sum(d2$Seg_Loc==2) #2802/4319
sum(d2$Seg_Mun==1) #923
sum(d2$Seg_Mun==2) #3387/4310
sum(d2$Alum==1) #2135
sum(d2$Alum==2) #2190/4325
sum(d2$Agua==1) #2030
sum(d2$Agua==2) #2299/4329
sum(d2$Pandill==1) #1337
sum(d2$Pandill==2) #2943/4280
sum(d2$Robos==1) #3228
sum(d2$Robos==2) #1068/4296
sum(d2$Del_Esc==1) #1540
sum(d2$Del_Esc==2) #1941/3481
sum(d2$Mas_Op_Del==1) #998
sum(d2$Mas_Op_Del==2) #2226/3214
sum(d2$Mas_Pat_Vil==1) #1723
sum(d2$Mas_Pat_Vil==2) #1934/3657
sum(d2$Vehic==1) #1833
sum(d2$Vehic==2) #2496/4329
}
set.seed(3)
for(i in 1:nrow(d1)){
d1$Seg_Loc[i] <- ifelse(d1$Seg_Loc[i]==9,rbernoulli(1,815/1077)+1,d1$Seg_Loc[i])
d1$Seg_Mun[i] <- ifelse(d1$Seg_Mun[i]==9,rbernoulli(1,937/1079)+1, d1$Seg_Mun[i])
d1$Alum[i] <- ifelse(d1$Alum[i]==9,rbernoulli(1,447/1082)+1,d1$Alum[i])
d1$Agua[i] <- ifelse(d1$Agua[i]==9,rbernoulli(1,506/1082)+1,d1$Agua[i])
d1$Pandill[i] <- ifelse(d1$Pandill[i]==9,rbernoulli(1,595/1063)+1,d1$Pandill[i])
d1$Robos[i] <- ifelse(d1$Robos[i]==9,rbernoulli(1,142/1079)+1,d1$Robos[i])
d1$Del_Esc[i] <- ifelse(d1$Del_Esc[i]==9,rbernoulli(1,351/888)+1,d1$Del_Esc[i])
d1$Mas_Op_Del[i] <- ifelse(d1$Mas_Op_Del[i]==9,rbernoulli(1,504/805)+1,d1$Mas_Op_Del[i])
d1$Mas_Pat_Vil[i] <- ifelse(d1$Mas_Pat_Vil[i]==9,rbernoulli(1,518/883)+1,d1$Mas_Pat_Vil[i])
d1$Vehic[i] <- ifelse(d1$Vehic[i]==9,rbernoulli(1,656/1081)+1,d1$Vehic[i])
}
for (i in 1:nrow(d2)){
d2$Seg_Loc[i] <- ifelse(d2$Seg_Loc[i]==9,rbernoulli(1,2802/4319)+1,d2$Seg_Loc[i])
d2$Seg_Mun[i] <- ifelse(d2$Seg_Mun[i]==9,rbernoulli(1,3387/4310)+1,d2$Seg_Mun[i])
d2$Alum[i] <- ifelse(d2$Alum[i]==9,rbernoulli(1,2190/4325)+1,d2$Alum[i])
d2$Agua[i] <- ifelse(d2$Agua[i]==9,rbernoulli(1,2299/4329)+1,d2$Agua[i])
d2$Pandill[i] <- ifelse(d2$Pandill[i]==9,rbernoulli(1,2943/4280)+1,d2$Pandill[i])
d2$Robos[i] <- ifelse(d2$Robos[i]==9,rbernoulli(1,1068/4296)+1,d2$Robos[i])
d2$Del_Esc[i] <- ifelse(d2$Del_Esc[i]==9,rbernoulli(1,1941/3481)+1,d2$Del_Esc[i])
d2$Mas_Op_Del[i] <- ifelse(d2$Mas_Op_Del[i]==9,rbernoulli(1,2226/3214)+1,d2$Mas_Op_Del[i])
d2$Mas_Pat_Vil[i] <- ifelse(d2$Mas_Pat_Vil[i]==9,rbernoulli(1,1934/3657)+1,d2$Mas_Pat_Vil[i])
d2$Vehic[i] <- ifelse(d2$Vehic[i]==9,rbernoulli(1,2496/4329)+1,d2$Vehic[i])
}
CData_CDMX <- rbind(d1,d2)
CData_CDMX$Nom_Mun <- as_factor(CData_CDMX$Nom_Mun)
CData_CDMX$Sexo <- as_factor(CData_CDMX$Sexo)
CData_CDMX$Niv_Edu <- as_factor(CData_CDMX$Niv_Edu)
CData_CDMX$Sit_Lab_Act <- as_factor(CData_CDMX$Sit_Lab_Act)
CData_CDMX$Pos_OCup <- as_factor(CData_CDMX$Pos_OCup)
CData_CDMX$Imp_Seg <- as_factor(CData_CDMX$Imp_Seg)
CData_CDMX$Seg_Loc <- as_factor(CData_CDMX$Seg_Loc)
CData_CDMX$Seg_Mun <- as_factor(CData_CDMX$Seg_Mun)
CData_CDMX$Alum <- as_factor(CData_CDMX$Alum)
CData_CDMX$Agua <- as_factor(CData_CDMX$Agua)
CData_CDMX$Pandill <- as_factor(CData_CDMX$Pandill)
CData_CDMX$Robos <- as_factor(CData_CDMX$Robos)
CData_CDMX$Del_Esc <- as_factor(CData_CDMX$Del_Esc)
CData_CDMX$Mas_Op_Del <- as_factor(CData_CDMX$Mas_Op_Del)
CData_CDMX$Mas_Pat_Vil <- as_factor(CData_CDMX$Mas_Pat_Vil)
CData_CDMX$Vehic <- as_factor(CData_CDMX$Vehic)
sum_fin <- summary(CData_CDMX)
CData_CDMX2<-CData_CDMX %>%
mutate(Vic_Rob_As=ifelse(Vic_Rob_As>0,1,0))
DF1<-Data_CDMX %>%
select(Vic_Rob_As,Seg_Loc) %>%
filter(Seg_Loc != 9)
DF1$Seg_Loc <- as_factor(DF1$Seg_Loc)
au <- hetcor(DF1)
au2 <- au$correlations
corrplot(au2)
DF2<-Data_CDMX %>%
select(Vic_Rob_As,Seg_Mun) %>%
filter(Seg_Mun != 9)
DF2$Seg_Mun <- as_factor(DF2$Seg_Mun)
au <- hetcor(DF2)
au2 <- au$correlations
corrplot(au2)
DF3<-Data_CDMX %>%
select(Vic_Rob_As,Alum) %>%
filter(Alum != 9)
DF3$Alum <- as_factor(DF3$Alum)
au <- hetcor(DF3)
au2 <- au$correlations
corrplot(au2)
DF4<-Data_CDMX %>%
select(Vic_Rob_As,Agua) %>%
filter(Agua != 9)
DF4$Agua <- as_factor(DF4$Agua)
au <- hetcor(DF4)
au2 <- au$correlations
corrplot(au2)
DF5<-Data_CDMX %>%
select(Vic_Rob_As,Pandill) %>%
filter(Pandill != 9)
DF5$Pandill <- as_factor(DF5$Pandill)
au <- hetcor(DF5)
au2 <- au$correlations
corrplot(au2)
DF6<-Data_CDMX %>%
select(Vic_Rob_As,Robos) %>%
filter(Robos != 9)
DF6$Robos <- as_factor(DF6$Robos)
au <- hetcor(DF6)
au2 <- au$correlations
corrplot(au2)
DF7<-Data_CDMX %>%
select(Vic_Rob_As, Del_Esc) %>%
filter(Del_Esc != 9)
DF7$Del_Esc <- as_factor(DF7$Del_Esc)
au <- hetcor(DF7)
au2 <- au$correlations
corrplot(au2)
DF8<-Data_CDMX %>%
select(Vic_Rob_As, Mas_Op_Del) %>%
filter(Mas_Op_Del != 9)
DF8$Mas_Op_Del <- as_factor(DF8$Mas_Op_Del)
au <- hetcor(DF8)
au2 <- au$correlations
corrplot(au2)
DF9<-Data_CDMX %>%
select(Vic_Rob_As, Mas_Pat_Vil) %>%
filter(Mas_Pat_Vil != 9)
DF9$Mas_Pat_Vil <- as_factor(DF9$Mas_Pat_Vil)
au <- hetcor(DF9)
au2 <- au$correlations
corrplot(au2)
DF10<-Data_CDMX %>%
select(Vic_Rob_As, Vehic) %>%
filter(Vehic != 9)
DF10$Vehic <- as_factor(DF10$Vehic)
au <- hetcor(DF10)
au2 <- au$correlations
corrplot(au2)
sum_fin <- summary(CData_CDMX2)
au <- hetcor(CData_CDMX2)
au2 <- au$correlations
corrplot(au2)
# Lo que hizo Pime
Data_CDMX.9 <- Data_CDMX %>% filter(Data_CDMX$Nom_Mun != 9, Data_CDMX$Sexo != 9,Data_CDMX$Niv_Edu != 9,Data_CDMX$Imp_Seg != 9,Data_CDMX$Seg_Loc!= 9,
Data_CDMX$Seg_Mun!= 9,Data_CDMX$Alum!= 9,Data_CDMX$Agua!= 9,Data_CDMX$Pandill!= 9,Data_CDMX$Robos!= 9,Data_CDMX$Del_Esc!= 9,
Data_CDMX$Mas_Op_Del!= 9, Data_CDMX$Mas_Pat_Vil!= 9, Data_CDMX$Vehic!= 9)
D1 <- Data_CDMX.9 %>% filter(Vic_Rob_As != 0)
D2 <- Data_CDMX.9 %>% filter(Vic_Rob_As == 0)
sum(D1$Vehic == 1)
sum(D2$Vehic == 1)
sum(D1$Mas_Pat_Vil == 1)
sum(D2$Mas_Pat_Vil == 1)
sum(D1$Mas_Op_Del == 1)
sum(D2$Mas_Op_Del == 1)
sum(D1$Del_Esc == 1)
sum(D2$Del_Esc == 1)
sum(D1$Robos == 1)
sum(D2$Robos == 1)
sum(D1$Pandill == 1)
sum(D2$Pandill == 1)
sum(D1$Agua == 1)
sum(D2$Agua == 1)
sum(D1$Alum == 1)
sum(D2$Alum == 1)
sum(D1$Seg_Mun == 1)
sum(D2$Seg_Mun == 1)
sum(D1$Seg_Loc == 1)
sum(D2$Seg_Loc == 1)
sum(D1$Imp_Seg == 1)
sum(D2$Imp_Seg == 1)
save(CData_CDMX,file="BD_CDMX_Imp.Rda")
library(ggplot2)
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Tasas <- (Datos_Tasas$TotalDelitos/Tasas)*100
Datos_Tasas <- tibble(Datos_Tasas, Tasas = signif(Tasas, digits = 4))
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
# scale_color_hue(l = 40, c = 35) +
# scale_fill_hue(l = 40, c = 35) +
coord_polar(theta = "y")  +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por Sexo
CData_CDMX1 %>% group_by(Sexo) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sexo, fill = Sexo)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Nivel Academico
CData_CDMX2 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Imp_Seg
CData_CDMX2 %>% group_by(Imp_Seg) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Imp_Seg, fill = Imp_Seg)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
# scale_color_hue(l = 40, c = 35) +
# scale_fill_hue(l = 40, c = 35) +
coord_polar(theta = "y")  +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(CData_CDMX2)
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
CData_CDMX1 <- CData_CDMX %>%
select(-Pos_OCup,-Seg_Loc,-Alum,-Agua,-Pandill,-Robos,-Del_Esc,-Mas_Op_Del)
## Eliminamos sexo
Region <- rep(0,length(CData_CDMX1$Nom_Mun))
for(i in 1:length(CData_CDMX1$Nom_Mun)){
if(CData_CDMX1$Nom_Mun[i] %in% c("Gustavo A. Madero","Venustiano Carranza","Iztacalco")){
Region[i] <- "Norte"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Cuauhtemoc","Miguel Hidalgo","Azcapotzalco","Alvaro Obregon","Cuajimalpa de Morelos")){
Region[i] <- "Centro Poniente"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Benito Juarez","Coyoacan","Tlalpan","La Magdalena Contreras")){
Region[i] <- "Sur"
}else if(CData_CDMX1$Nom_Mun[i] %in% c("Iztapalapa","Tlahuac","Xochimilco","Milpa Alta")){
Region[i] <- "Oriente"
}
}
Nivel_Edu <- rep("",length(CData_CDMX1$Niv_Edu))
for(i in 1:length(CData_CDMX1$Niv_Edu)){
if(CData_CDMX1$Niv_Edu[i] %in% c(1,2)){
Nivel_Edu[i]<-"Prepri/Prim"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(3,4,5)){
Nivel_Edu[i]<-"Secundaria"
}else if(CData_CDMX1$Niv_Edu[i] %in% c(6,7)){
Nivel_Edu[i]<-"Medio Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 8){
Nivel_Edu[i]<-"Superior"
}else if(CData_CDMX1$Niv_Edu[i] == 9){
Nivel_Edu[i]<-"Posgrado"
}else if(CData_CDMX1$Niv_Edu[i] == 0){
Nivel_Edu[i]<-"Ninguno"
}
}
CData_CDMX2 <- CData_CDMX1 %>%
select(-Sexo, -Nom_Mun, -Niv_Edu) %>%
mutate(Region =Region, Nivel_Edu=Nivel_Edu)
CData_CDMX2$Region <- as_factor(CData_CDMX2$Region)
CData_CDMX2$Nivel_Edu <- factor(CData_CDMX2$Nivel_Edu,levels=c("Ninguno","Prepri/Prim","Secundaria","Medio Superior","Superior","Posgrado"),ordered = T)
load(file = "BD_CDMX2_Imp.Rda")
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Tasas <- (Datos_Tasas$TotalDelitos/Tasas)*100
Datos_Tasas <- tibble(Datos_Tasas, Tasas = signif(Tasas, digits = 4))
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
# scale_color_hue(l = 40, c = 35) +
# scale_fill_hue(l = 40, c = 35) +
coord_polar(theta = "y")  +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por Sexo
CData_CDMX1 %>% group_by(Sexo) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sexo, fill = Sexo)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Nivel Academico
CData_CDMX2 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Imp_Seg
CData_CDMX2 %>% group_by(Imp_Seg) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Imp_Seg, fill = Imp_Seg)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Seg_Mun
CData_CDMX2 %>% group_by(Seg_Mun) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Seg_Mun, fill = Seg_Mun)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(Total = sum(Sit_Lab_Act))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(Total = count(Sit_Lab_Act))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Nivel Academico
CData_CDMX2 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Gráfica por Nivel Academico
CData_CDMX2 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(Total = count(Sit_Lab_Act))
CData_CDMX2 %>%
ggplot(aes(x = "", y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>%
ggplot(aes(x = "", y = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>%
ggplot(aes(x = Sit_Lab_Act, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(color = "White")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(Total = sum(Sit_Lab_Act))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab_Act, fill = Sit_Lab_Act)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX2 %>% group_by(Sit_Lab_Act) %>% summarise(TotalDelitos = sum(Vic_Rob_As))
summary(CData_CDMX2)
