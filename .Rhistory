beta1[1] <- 0
beta1[2] ~ dnorm(0.0, 0.0001)
beta2[1] <- 0
beta2[2] ~ dnorm(0.0, 0.0001)
beta2[3] ~ dnorm(0.0, 0.0001)
beta2[4] ~ dnorm(0.0, 0.0001)
}
"
fit2 <- jags.model(textConnection(modelo2), data, inits, n.chains = 2)
update(fit2, 2000)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
set.seed(2021)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
set.seed(2027)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample1)
summary(sample1)
mnull <- update(mod_dis_4, . ~ 1)
library(pscl)
library(VGAM)
mod_dist_4 <- zeroinfl(Vic_Rob_As ~ Seg_Mun  + Region |
Edad + Mas_Pat_Vil + Region + Sit_Lab,
data= CData_CDMX2, dist="poisson",link="logit")
summary(mod_dist_4)
mnull <- update(mod_dis_4, . ~ 1)
mnull <- update(mod_dist_4, . ~ 1)
pchisq(2*(logLik(mod_dist_4) - Loglik(mnull)), df = 6, lower.tail = FALSE)
pchisq(2*(logLik(mod_dist_4) - logLik(mnull)), df = 6, lower.tail = FALSE)
summary(mod_pois_4 <- glm(Vic_Rob_As ~ Seg_Mun + Region, family = "poison", data = CData_CDMX2))
summary(mod_pois_4 <- glm(Vic_Rob_As ~ Seg_Mun + Region, family = poisson, data = CData_CDMX2))
vuong(mod_dist_4, mod_pois_4)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
######## como Viene en el libro (Creo que no convergen )
modelo2 = "model{
for(i in 1:n){
y[i] ~ dpois(mu[i])
mu[i] <- (u[i] + 0.0000001)*lambda[i]
u[i] ~ dbern(p[i])
logit(p[i]) <- alpha0 + alpha1*X1[i] + alpha2[X2[i]] + alpha3[X3[i]] + alpha4[X4[i]]
log(lambda[i]) <- beta0 + beta1[X5[i]] + beta2[X3[i]]
zdp[i] <- (1 - p[i]) + p[i]*exp(-lambda[i])}
#### Priors
alpha0 ~ dnorm(0.0, 1.0)
beta0 ~ dnorm(0.0, 1.0)
alpha1 ~ dnorm(0.0, 1.0)
alpha2[1] <- 0
alpha2[2] ~ dnorm(0.0, 1.0)
alpha3[1] <- 0
alpha3[2] ~ dnorm(0.0, 1.0)
alpha3[3] ~ dnorm(0.0, 1.0)
alpha3[4] ~ dnorm(0.0, 1.0)
alpha4[1] <- 0
alpha4[2] ~ dnorm(0.0, 1.0)
alpha4[3] ~ dnorm(0.0, 1.0)
beta1[1] <- 0
beta1[2] ~ dnorm(0.0, 1.0)
beta2[1] <- 0
beta2[2] ~ dnorm(0.0, 1.0)
beta2[3] ~ dnorm(0.0, 1.0)
beta2[4] ~ dnorm(0.0, 1.0)
}
"
fit2 <- jags.model(textConnection(modelo2), data, inits, n.chains = 2)
update(fit2, 2000)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
######## como Viene en el libro (Creo que no convergen )
modelo2 = "model{
for(i in 1:n){
y[i] ~ dpois(mu[i])
mu[i] <- (u[i] + 0.00000001)*lambda[i]
u[i] ~ dbern(p[i])
logit(p[i]) <- alpha0 + alpha1*X1[i] + alpha2[X2[i]] + alpha3[X3[i]] + alpha4[X4[i]]
log(lambda[i]) <- beta0 + beta1[X5[i]] + beta2[X3[i]]
zdp[i] <- (1 - p[i]) + p[i]*exp(-lambda[i])}
#### Priors
alpha0 ~ dnorm(0.0, 0.0001)
beta0 ~ dnorm(0.0, 0.0001)
alpha1 ~ dnorm(0.0, 0.0001)
alpha2[1] <- 0
alpha2[2] ~ dnorm(0.0, 0.0001)
alpha3[1] <- 0
alpha3[2] ~ dnorm(0.0, 0.0001)
alpha3[3] ~ dnorm(0.0, 0.0001)
alpha3[4] ~ dnorm(0.0, 0.0001)
alpha4[1] <- 0
alpha4[2] ~ dnorm(0.0, 0.0001)
alpha4[3] ~ dnorm(0.0, 0.0001)
beta1[1] <- 0
beta1[2] ~ dnorm(0.0, 0.0001)
beta2[1] <- 0
beta2[2] ~ dnorm(0.0, 0.0001)
beta2[3] ~ dnorm(0.0, 0.0001)
beta2[4] ~ dnorm(0.0, 0.0001)
}
"
fit2 <- jags.model(textConnection(modelo2), data, inits, n.chains = 2)
update(fit2, 2000)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 2500, thin = 1)
plot(sample2)
summary(sample2)
fit2 <- jags.model(textConnection(modelo2), data, inits, n.chains = 2)
update(fit2, 5000)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 5000, thin = 1)
plot(sample2)
summary(sample2)
log(Edad)
#### JAGS
attach(CData_CDMX2)
data <- list(
y = Vic_Rob_As,
X1 = log(Edad),
X2 = Mas_Pat_Vil,
X3 = as.numeric(Region),
X4 = as.numeric(Sit_Lab),
X5 = Seg_Mun,
n =length(Vic_Rob_As)
)
param <- c("alpha0", "alpha1", "alpha2", "alpha3", "alpha4", "beta0", "beta1", "beta2")
inits <- function(){ list(
"alpha0" = rnorm(1),
"alpha1" = rnorm(1),
"beta0" = rnorm(1)
)
}
###### Con este sí convergen, pero difieren mucho los frecuentistas con el Bayesiano
modelo1 = "model{
for(i in 1:n){
y[i] ~ dpois(mu[i])
mu[i] <- (1-u[i]+0.0000001)*lambda[i]
u[i] ~ dbern(p[i])
logit(p[i]) <- alpha0 + alpha1*X1[i] + alpha2[X2[i]] + alpha3[X3[i]] + alpha4[X4[i]]
log(lambda[i]) <- beta0 + beta1[X5[i]] + beta2[X3[i]]
zdp[i] <- p[i] + (1-p[i])*exp(-lambda[i])}
#### Priors
alpha0 ~ dnorm(0.0, 0.0001)
beta0 ~ dnorm(0.0, 0.0001)
alpha1 ~ dnorm(0.0, 0.0001)
alpha2[1] <- 0
alpha2[2] ~ dnorm(0.0, 0.0001)
alpha3[1] <- 0
alpha3[2] ~ dnorm(0.0, 0.0001)
alpha3[3] ~ dnorm(0.0, 0.0001)
alpha3[4] ~ dnorm(0.0, 0.0001)
alpha4[1] <- 0
alpha4[2] ~ dnorm(0.0, 0.0001)
alpha4[3] ~ dnorm(0.0, 0.0001)
beta1[1] <- 0
beta1[2] ~ dnorm(0.0, 0.0001)
beta2[1] <- 0
beta2[2] ~ dnorm(0.0, 0.0001)
beta2[3] ~ dnorm(0.0, 0.0001)
beta2[4] ~ dnorm(0.0, 0.0001)
}
"
fit1 <- jags.model(textConnection(modelo1), data, inits, n.chains = 2)
update(fit1, 5000)
set.seed(1)
sample2 <- coda.samples(fit2, param, n.iter = 5000, thin = 1)
plot(sample2)
summary(sample2)
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
library(tidyverse)
library(ggplot2)
#Analisis Descriptivo
library(tidyverse)
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Tasas <- (Datos_Tasas$TotalDelitos/Tasas)*100
Datos_Tasas <- tibble(Datos_Tasas, Tasas = signif(Tasas, digits = 4))
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%")), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = "", y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
Datos_Tasas <- tibble(Datos_Tasas, Tasas = signif(Tasas, digits = 4))
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Tasas <- (Datos_Tasas$TotalDelitos/Tasas)*100
Datos_Tasas <- tibble(Datos_Tasas, Tasas = signif(Tasas, digits = 4))
View(Datos_Tasas)
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = TotalDelitos, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL) + coord_flip()
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL)# theme(axis.text.x = element_text(size = 7, angle = 45))
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
geom_text(aes(label = paste0(Tasas, "%"))) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Blues")
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
# Gráfica por Sexo
CData_CDMX1 %>% group_by(Sexo) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sexo, fill = Sexo)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Tablas con gráfica
as_tibble(xtabs(~ Vic_Rob_As+ Imp_Seg, data = CData_CDMX2)) %>% ggplot() + geom_bar(aes(x=Vic_Rob_As, y = n), stat = "identity")
as_tibble(xtabs(~ Vic_Rob_As+ Imp_Seg, data = CData_CDMX2))
as_tibble(xtabs(~ Imp_Seg + Vic_Rob_As, data = CData_CDMX2))
# Tablas con gráfica
as_tibble(xtabs(~ Imp_Seg + Vic_Rob_As, data = CData_CDMX2)) %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Imp_Seg), stat = "identity", color = "black", position = position_dodge())
View(CData_CDMX2)
View(Data_CDMX)
as_tibble(xtabs(~ Seg_Mun + Vic_Rob_As , data = CData_CDMX2)) %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Seg_Mun), stat = "identity", color = "black", position = position_dodge())
# Mas Patrullas Vigilando
as_tibble(xtabs(~ Mas_Pat_Vil + Vic_Rob_As, data = CData_CDMX2)) %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Mas_Pat_Vil), stat = "identity", color = "black", position = position_dodge())
# Region
as_tibble(xtabs(~ Region + Vic_Rob_As , data = CData_CDMX2)) %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Region), stat = "identity", color = "black", position = position_dodge())
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Nivel_Edu), stat = "identity", color = "black", position = position_dodge())
# Sit_Lab
as_tibble(xtabs(~ Vic_Rob_As + Sit_Lab , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Sit_Lab), stat = "identity", color = "black", position = position_dodge())
ggplot(CData_CDMX2, aes(x = Vic_Rob_As , y = Edad)) +
geom_boxplot()
# Sit_Lab
as_tibble(xtabs(~ Vic_Rob_As + Sit_Lab , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Sit_Lab), stat = "identity", color = "black", position = position_dodge())
ggplot(CData_CDMX2, aes(x = Vic_Rob_As , y = Edad)) +
geom_boxplot() + facet_wrap()
ggplot(CData_CDMX2, aes(x = Vic_Rob_As , y = Edad)) +
geom_boxplot() + facet_wrap(~ Vic_Rob_As)
ggplot(CData_CDMX2, aes(x = as_factor(Vic_Rob_As) , y = Edad)) +
geom_boxplot()
View(Datos_Tasas)
dim(CData_CDMX2 %>% filter(Vic_Rob_As = "Centro Poniente"))[1]
dim(CData_CDMX2 %>% filter(Vic_Rob_As == "Centro Poniente"))[1]
dim(CData_CDMX2 %>% filter(Vic_Rob_As == "Centro Poniente"))
CData_CDMX2 %>% filter(Vic_Rob_As == "Centro Poniente")
dim(CData_CDMX2 %>% filter(Region == "Centro Poniente")
dim(CData_CDMX2 %>% filter(Region == "Centro Poniente"))
x <- c("Centro Poniente", "Sur", "Norte", "Oriente")
y <- c(dim(CData_CDMX2 %>% filter(Region == "Centro Poniente"))[1],
dim(CData_CDMX2 %>% filter(Region == "Sur"))[1],
dim(CData_CDMX2 %>% filter(Region == "Norte"))[1],
dim(CData_CDMX2 %>% filter(Region == "Oriente"))[1]
)
z <- c(dim(CData_CDMX2 %>% filter(Region == "Centro Poniente"))[1],
dim(CData_CDMX2 %>% filter(Region == "Sur"))[1],
dim(CData_CDMX2 %>% filter(Region == "Norte"))[1],
dim(CData_CDMX2 %>% filter(Region == "Oriente"))[1]
)
Datos_Tasas %>% add_row(x,y,z)
Datos_Tasas %>% add_row(Region = x,TotalDelitos = y,Tasas = z)
# Gráfica por región # Modificar
Datos_Tasas %>%
ggplot(aes(x = Region, y = Tasas, fill = Region)) +
geom_bar(stat = "identity", color = "White") +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
library(plyr)
Datos_Tasas_Sorted <- arrange(Datos_Tasas, TotalDelitos, Tasas)
head(Datos_Tasas_Sorted)
View(Datos_Tasas_Sorted)
Tasas
Datos_Tasas_Total <- tibble(Indicador = rep(c("Total Población", "Tasa"), each = 4),
Region = rep(x, 2), Valores = c(z,Tasas))
View(Datos_Tasas_Total)
# Gráfica por región # Modificar
Datos_Tasas_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White") +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
# Gráfica por región # Modificar
Datos_Tasas_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Total_Rob <- Datos_Tasas$TotalDelitos
Datos_Tasas <- CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(Datos_Tasas)
CData_CDMX2 %>% group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(CData_CDMX2)
Datos_Tasas <- CData_CDMX2 %>% group_by(as_factor(Region)) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(Datos_Tasas)
#Analisis Descriptivo
library(tidyverse)
Datos_Tasas <- CData_CDMX2 %>% tidyverse::group_by(as_factor(Region)) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Datos_Tasas <- CData_CDMX2 %>% dplyr::group_by(as_factor(Region)) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(Datos_Tasas)
Datos_Tasas <- CData_CDMX2 %>% dplyr::group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
View(Datos_Tasas)
CData_CDMX2 %>% dplyr::group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
#Analisis Descriptivo
library(tidyverse)
CData_CDMX2 %>% dplyr::group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Datos_Tasas <- CData_CDMX2 %>% dplyr::group_by(Region) %>%
summarise(TotalDelitos = sum(Vic_Rob_As))
Tasas <- rep(0,4)
for (i in 1:4) {
aux1 <- CData_CDMX2 %>% filter(Region == Datos_Tasas$Region[i])
Tasas[i] <- length(aux1$Vic_Rob_As)
}
Total_Rob <- Datos_Tasas$TotalDelitos
Total_Rob <- Datos_Tasas$TotalDelitos
Datos_Rob_Total <- tibble(Indicador = rep(c("Total Población", "Total Robos/Asaltos"), each = 4),
Region = rep(x, 2), Valores = c(z,Total_Rob))
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
Datos_Rob_Total <- tibble(Indicador = rep(c("Población Encuestada", "Población Siniestrada"), each = 4),
Region = rep(x, 2), Valores = c(z,Total_Rob))
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL) +
# theme(axis.text.x = element_text(size = 7, angle = 45))
scale_fill_brewer(palette = "Reds")
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL) + + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9"))
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "White", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL)  + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9"))
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL)  + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9"))
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL)  + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9")) xlab("Región") + ylab("Personas")
# Gráfica por región # Modificar
Datos_Rob_Total %>%
ggplot(aes(x = Region, y = Valores, fill = Indicador)) +
geom_bar(stat = "identity", color = "black", position = position_dodge()) +
labs(x = NULL, y = NULL, fill = NULL)  + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9"))+ xlab("Región") + ylab("Personas")
# Gráfica por Situación Laboral
CData_CDMX2 %>% group_by(Sit_Lab) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Sit_Lab, fill = Sit_Lab)) +
geom_bar(color = "White", stat = "identity") +
coord_polar(theta = "y")
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Nivel_Edu), stat = "identity", color = "black", position = position_dodge())
(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2)
xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2)
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = arrange(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge())
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge())
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9"))
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9", "#254DBC","#BABC25", "#25BC76"))
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2 %>% filter(Vic_Rob_As %in% c(0,1))))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9", "#254DBC","#BABC25", "#25BC76"))
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2 %>% filter(Vic_Rob_As > 1))  %>% ggplot() +
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2 > 1))%>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9", "#254DBC","#BABC25", "#25BC76"))
# Sit_Lab
as_tibble(xtabs(~ Vic_Rob_As + Sit_Lab , data = CData_CDMX2))  %>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = Sit_Lab), stat = "identity", color = "black", position = position_dodge())
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX2 %>% filter(Vic_Rob_As > 1)))%>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9", "#254DBC","#BABC25", "#25BC76"))
CData_CDMX2_sin7 <- CData_CDMX2 %>% filter(Vic_Rob_As < 7)
# Gráfica por Nivel Academico
CData_CDMX3 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
CData_CDMX3 <- CData_CDMX2 %>% filter(Vic_Rob_As < 7)
# Gráfica por Nivel Academico
CData_CDMX3 %>% group_by(Nivel_Edu) %>% summarise(TotalDelitos = sum(Vic_Rob_As))%>%
ggplot(aes(x = "", y = TotalDelitos, color = Nivel_Edu, fill = Nivel_Edu)) +
geom_bar(stat = "identity", color = "White") +
coord_polar(theta = "y")
# Nivel Educativo
as_tibble(xtabs(~ Vic_Rob_As + Nivel_Edu , data = CData_CDMX3 %>% filter(Vic_Rob_As > 1)))%>% ggplot() +
geom_bar(aes(x=Vic_Rob_As, y = n, fill = sort(Nivel_Edu)), stat = "identity", color = "black", position = position_dodge()) +
xlab("Víctima de Robo/Asalto") + ylab("Personas") + labs(fill = "Nivel Educativo") + theme_bw() + scale_fill_manual(values = c("#00B8C2","#6562C9", "#254DBC","#BABC25", "#25BC76"))
