select(-ID_PER, -CVE_ENT, -CVE_MUN, -AP6_1_2) %>%
filter(AP7_3_05 != 9,AP7_3_06 != 9,AP7_3_07 != 9,AP7_3_08 != 9,AP7_3_09 != 9,
AP7_3_10 != 9,AP7_3_11 != 9,AP7_3_12 != 9,AP7_3_13 != 9,AP7_3_14 != 9,AP7_3_15 != 9) %>%
mutate(AP7_4_05 = replace_na( AP7_4_05, 0), AP7_4_06 = replace_na(AP7_4_06, 0),AP7_4_07 = replace_na( AP7_4_07, 0),
AP7_4_08 = replace_na( AP7_4_08, 0),AP7_4_09 = replace_na( AP7_4_09, 0),AP7_4_10 = replace_na( AP7_4_10, 0),
AP7_4_11 = replace_na( AP7_4_11, 0),AP7_4_12 = replace_na( AP7_4_12, 0),AP7_4_13 = replace_na( AP7_4_13, 0),
AP7_4_14 = replace_na( AP7_4_14, 0),AP7_4_15 = replace_na( AP7_4_15, 0)) %>%
select(-AP7_3_05,-AP7_3_06,-AP7_3_07,-AP7_3_08,-AP7_3_09,-AP7_3_10,-AP7_3_11,-AP7_3_12,-AP7_3_13,-AP7_3_14,-AP7_3_15)
#mutate(Num_Inc = AP7_4_13 + AP7_4_14) %>%
#select(-AP7_4_13, -AP7_4_14)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
library(tidyverse)
Data_raw_Sec3 <- read_csv("Sec3.csv"#, col_types = list(col_character(), col_factor(), col_integer(),
#  col_integer(), col_integer(), col_character(),
# col_integer(), col_character(), col_integer(),
) #col_integer()))
Data_raw_Sec45 <- read_csv("sec45.csv")
Data_raw_Sec67 <- read_csv("sec67.csv")
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3","beta4","beta5","beta6")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1),
"beta5" = rnorm(1),
"beta6" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
library(rjags)
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3","beta4","beta5","beta6")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1),
"beta5" = rnorm(1),
"beta6" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
setwd("C:/Users/edson/Documents/BayesProject")
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
load("C:/Users/edson/Documents/BayesProject/BD_CDMX2.Rda")
##Creamos base con respuesta 1 y 0
CData_CDMX3 <- CData_CDMX2 %>%
mutate(Vic_Rob_As = ifelse(Vic_Rob_As>0,1,0))
CData_CDMX3$Vic_Rob_As <- as_factor(CData_CDMX3$Vic_Rob_As)
library(rjags)
library(tidyverse)
library(ROCR)
library(pROC)
library(car)
CData_CDMX3 <- CData_CDMX2 %>%
mutate(Vic_Rob_As = ifelse(Vic_Rob_As>0,1,0))
CData_CDMX3$Vic_Rob_As <- as_factor(CData_CDMX3$Vic_Rob_As)
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3","beta4","beta5","beta6")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1),
"beta5" = rnorm(1),
"beta6" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
modlog1 <- glm(Vic_Rob_As ~ .,family = "binomial", data=CData_CDMX3)
summary(modlog1)
predictions1 <- prediction(modlog1$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions1, "sens")@x.values), unlist(performance(predictions1, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions1, "spec")@x.values), unlist(performance(predictions1, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest1 <- abs(unlist(performance(predictions1, "sens")@y.values)-unlist(performance(predictions1, "spec")@y.values))
opt1 <- unlist(performance(predictions1, "sens")@x.values)[which(rest1==min(rest1))]
vif(modlog1)
r <- ifelse(modlog1$fitted.values>=opt1,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
modlog2 <- glm(Vic_Rob_As ~ Edad + Sit_Lab + Seg_Mun + Mas_Pat_Vil + Nivel_Edu + Region, family = "binomial",data=CData_CDMX3)
summary(modlog2)
predictions2 <- prediction(modlog2$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions2, "sens")@x.values), unlist(performance(predictions2, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions2, "spec")@x.values), unlist(performance(predictions2, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest2 <- abs(unlist(performance(predictions2, "sens")@y.values)-unlist(performance(predictions2, "spec")@y.values))
opt2 <- unlist(performance(predictions2, "sens")@x.values)[which(rest2==min(rest2))]
vif(modlog2)
r <- ifelse(modlog2$fitted.values>=opt2,1,0)
table(r,CData_CDMX3$Vic_Rob_As)  ##
summary(modlog2)
outlierTest(modlog2)
modlog1 <- glm(Vic_Rob_As ~ .,family = binomial(link = "loglog"), data=CData_CDMX3)
modlog1 <- glm(Vic_Rob_As ~ .,family = binomial(link = "log"), data=CData_CDMX3)
summary(modlog1)
modlog1 <- glm(Vic_Rob_As ~ .,family = binomial(link = "log"), data=CData_CDMX3)
summary(modlog1)
## Hallamos punto de corte gráfica y teóricamente
predictions1 <- prediction(modlog1$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions1, "sens")@x.values), unlist(performance(predictions1, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions1, "spec")@x.values), unlist(performance(predictions1, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest1 <- abs(unlist(performance(predictions1, "sens")@y.values)-unlist(performance(predictions1, "spec")@y.values))
opt1 <- unlist(performance(predictions1, "sens")@x.values)[which(rest1==min(rest1))]
vif(modlog1)
#Matriz de Confusión
r <- ifelse(modlog1$fitted.values>=opt1,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
(2699+675)/5419
modlog1 <- glm(Vic_Rob_As ~ .,family = binomial(link = "clog"), data=CData_CDMX3)
modlog1 <- glm(Vic_Rob_As ~ .,family = binomial(link = "cloglog"), data=CData_CDMX3)
summary(modlog1)
predictions1 <- prediction(modlog1$fitted.values,CData_CDMX3$Vic_Rob_As)
plot(unlist(performance(predictions1, "sens")@x.values), unlist(performance(predictions1, "sens")@y.values),
type="l", lwd=2, ylab="Sensitivity", xlab="Punto de Corte")
par(new=TRUE)
plot(unlist(performance(predictions1, "spec")@x.values), unlist(performance(predictions1, "spec")@y.values),
type="l", lwd=2, col='red', ylab="", xlab="")
rest1 <- abs(unlist(performance(predictions1, "sens")@y.values)-unlist(performance(predictions1, "spec")@y.values))
opt1 <- unlist(performance(predictions1, "sens")@x.values)[which(rest1==min(rest1))]
vif(modlog1)
#Matriz de Confusión
r <- ifelse(modlog1$fitted.values>=opt1,1,0)
table(r,CData_CDMX3$Vic_Rob_As)
(2707+675)/5419
#Ejemplo
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*42)/(1+exp(b0_2+b1_2*42))
lam<-exp(b0_1+b1_1*42)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 42)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
CData_CDMX2_1 <-CData_CDMX2 %>%
select(-Vic_Rob_As)
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*42)/(1+exp(b0_2+b1_2*42))
lam<-exp(b0_1+b1_1*42)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 42)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
CData_CDMX2_1 <-CData_CDMX2 %>%
select(-Vic_Rob_As)
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm<-summary(mod)
sglm
library(pscl)
library(boot)
mod<-zeroinfl(Vic_Rob_As ~ Edad,data=CData_CDMX2,dist="poisson",link="logit")
sglm<-summary(mod)
sglm
#Ejemplo
b0_1 <- sglm$coefficients[[1]][1,1]
b1_1 <- sglm$coefficients[[1]][2,1]
b0_2 <- sglm$coefficients[[2]][1,1]
b1_2 <- sglm$coefficients[[2]][2,1]
logit<-exp(b0_2+b1_2*42)/(1+exp(b0_2+b1_2*42))
lam<-exp(b0_1+b1_1*42)
vec<-rep(0,10)
for(t in 0:9){
if(t==0){
vec[t+1]<-logit+(1-logit)*dpois(t,lam)
}else{
vec[t+1]<-(1-logit)*dpois(t,lam)
}
}
Edad42<-CData_CDMX2 %>%
filter(Edad == 42)
vec1 <- rep(vec[1:8],775)[1:5419]
v<-rep(0:7,775)[1:5419]
ggplot(CData_CDMX2) +
geom_bar(aes(x=Vic_Rob_As,y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) + geom_point(aes(x=v , y=vec1))
library(rjags)
library(tidyverse)
library(ROCR)
library(pROC)
library(car)
data <- list(
y = CData_CDMX3$Vic_Rob_As,
x1 = CData_CDMX3$Edad,
x2 = CData_CDMX3$Sit_Lab,
x3 = CData_CDMX3$Seg_Mun,
x4 = CData_CDMX3$Mas_Pat_Vil,
x5 = CData_CDMX3$Region,
x6 = CData_CDMX3$Nivel_Edu,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta2","beta3","beta4","beta5","beta6")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta2" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1),
"beta5" = rnorm(1),
"beta6" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
summary(modlog1)
modlog2 <- glm(Vic_Rob_As ~ Edad + Seg_Mun + Mas_Pat_Vil, family = "binomial",data=CData_CDMX3)
summary(modlog2)
attach(CData_CDMX3)
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = Edad,
x3 = as.numeric(Seg_Mun)-1,
x4 = as.numeric(Mas_Pat_Vil)-1,
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta1","beta3","beta4")
inits<-function(){list(
"alpha" = rnorm(1),
"beta1" = rnorm(1),
"beta3" = rnorm(1),
"beta4" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
as.numeric(CData_CDMX3$Nivel_Edu == "No Básica")
levels(CData_CDMX3$Nivel_Edu)
modlog3 <- glm(Vic_Rob_As ~ Nivel_Edu, family = "binomial",data=CData_CDMX3)
attach(CData_CDMX3)
# data <- list(
#   y = as.numeric(Vic_Rob_As)-1,
#   x1 = Edad,
#   x3 = as.numeric(Seg_Mun)-1,
#   x4 = as.numeric(Mas_Pat_Vil)-1,
#   n = nrow(CData_CDMX3)
# )
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "No Básica"),
x2 = as.numeric(Nivel_Edu == "Secundaria"),
x3 = as.numeric(Nivel_Edu == "Medio Superior"),
x4 = as.numeric(Nivel_Edu == "Superior"),
x5 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
data
summary(data)
attach(CData_CDMX3)
# data <- list(
#   y = as.numeric(Vic_Rob_As)-1,
#   x1 = Edad,
#   x3 = as.numeric(Seg_Mun)-1,
#   x4 = as.numeric(Mas_Pat_Vil)-1,
#   n = nrow(CData_CDMX3)
# )
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "No Básica"),
x2 = as.numeric(Nivel_Edu == "Secundaria"),
x3 = as.numeric(Nivel_Edu == "Medio Superior"),
x4 = as.numeric(Nivel_Edu == "Superior"),
x5 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta11","beta12","beta13","beta14","beta15")
inits<-function(){list(
"alpha" = rnorm(1),
"beta11" = rnorm(1),
"beta12" = rnorm(1),
"beta13" = rnorm(1),
"beta14" = rnorm(1),
"beta15" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
summary(modlog3)
plot(sample)
summary(modlog3)
modlog4 <- glm(Vic_Rob_As ~ Region, family = "binomial",data=CData_CDMX4)
modlog4 <- glm(Vic_Rob_As ~ Region, family = "binomial",data=CData_CDMX3)
summary(modlog4)
levels(CData_CDMX3$Region)
attach(CData_CDMX3)
# data <- list(
#   y = as.numeric(Vic_Rob_As)-1,
#   x1 = Edad,
#   x3 = as.numeric(Seg_Mun)-1,
#   x4 = as.numeric(Mas_Pat_Vil)-1,
#   n = nrow(CData_CDMX3)
# )
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Region == "Centro Poniente"),
x2 = as.numeric(Region == "Sur"),
x3 = as.numeric(Region == "Norte"),
x4 = as.numeric(Region == "Oriente"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta11","beta12","beta13","beta14")
inits<-function(){list(
"alpha" = rnorm(1),
"beta11" = rnorm(1),
"beta12" = rnorm(1),
"beta13" = rnorm(1),
"beta14" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
summary(modlog4)
sample
View(sample)
summ <- summary(sample)
View(summ)
summ$statistics
summ$statistics[1,]
summ$statistics[,1]
levels(CData_CDMX3$Nivel_Edu)
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Region == "No Básica"),
x2 = as.numeric(Region == "Secundaria"),
x3 = as.numeric(Region == "Medio Superior"),
x4 = as.numeric(Region == "Superior"),
x4 = as.numeric(Region == "Posgrado"),
n = nrow(CData_CDMX3)
)
list
data
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "No Básica"),
x2 = as.numeric(Nivel_Edu == "Secundaria"),
x3 = as.numeric(Nivel_Edu == "Medio Superior"),
x4 = as.numeric(Nivel_Edu == "Superior"),
x5 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
data
sum(data$y)
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "No Básica"),
x2 = as.numeric(Nivel_Edu == "Secundaria"),
x3 = as.numeric(Nivel_Edu == "Medio Superior"),
x4 = as.numeric(Nivel_Edu == "Superior"),
x5 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta11","beta12","beta13","beta14","beta15")
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "No Básica"),
x2 = as.numeric(Nivel_Edu == "Secundaria"),
x3 = as.numeric(Nivel_Edu == "Medio Superior"),
x4 = as.numeric(Nivel_Edu == "Superior"),
x5 = as.numeric(Nivel_Edu == "Posgrado"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta11","beta12","beta13","beta14","beta15")
inits<-function(){list(
"alpha" = rnorm(1),
"beta11" = rnorm(1),
"beta12" = rnorm(1),
"beta13" = rnorm(1),
"beta14" = rnorm(1),
"beta15" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
modlog2 <- glm(Vic_Rob_As ~ Nivel_Edu, family = "binomial",data=CData_CDMX3)
summary(modlog2)
levels(CData_CDMX3$Sit_Lab)
data <- list(
y = as.numeric(Vic_Rob_As)-1,
x1 = as.numeric(Nivel_Edu == "Empleado"),
x2 = as.numeric(Nivel_Edu == "Sin Ocupación"),
x3 = as.numeric(Nivel_Edu == "Estudiantes y Domésticos"),
n = nrow(CData_CDMX3)
)
param <- c("alpha","beta11","beta12","beta13")
inits<-function(){list(
"alpha" = rnorm(1),
"beta11" = rnorm(1),
"beta12" = rnorm(1),
"beta13" = rnorm(1)
)
}
fit <- jags.model("Modelo.bug", data, inits, n.chains=3)
update(fit,1000)
sample <- coda.samples(fit,param,n.iter = 4000)
plot(sample)
summary(sample)
modlog4 <- glm(Vic_Rob_As ~ Sit_Lab, family = "binomial",data=CData_CDMX3)
summary(modlog4)
modlog4 <- glm(Vic_Rob_As ~ Region, family = "binomial",data=CData_CDMX3)
summary(modlog4)
